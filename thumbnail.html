<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>YouTube превью</title>
<style>
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#f6f7fb;color:#0c0c0d}
  .wrap{max-width:960px;margin:0 auto;padding:22px 14px 40px}
  h1{margin:0 0 14px;font-size:1.4rem;text-align:center}
  .card{background:#fff;border:1px solid #e6e9f2;border-radius:12px;padding:16px;box-shadow:0 1px 0 rgba(0,0,0,.03)}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center}
  input[type="url"]{flex:1 1 560px;max-width:760px;padding:12px 14px;font-size:1rem;border:1px solid #cfd5e1;border-radius:10px}
  .preview{margin-top:16px;display:flex;justify-content:center}
  .preview a{display:block;width:100%;max-width:860px}
  .preview img{width:100%;height:auto;border-radius:12px;border:1px solid #e6e9f2;background:#eef2ff}
</style>
</head>
<body>
<div class="wrap">
  <h1>Скачать YouTube превью</h1>

  <div class="card">
    <div class="row">
      <input id="yturl" type="url" placeholder="Вставьте ссылку на YouTube видео..." autocomplete="off">
    </div>

    <div class="preview" id="out" hidden>
      <a id="thumbLink" target="_blank" rel="noopener">
        <img id="thumb" alt="Превью YouTube">
      </a>
    </div>
  </div>
</div>

<script>
  const input = document.getElementById('yturl');
  const out   = document.getElementById('out');
  const img   = document.getElementById('thumb');
  const link  = document.getElementById('thumbLink');

  const placeholder = "https://placehold.co/800x450?text=Вставьте+ссылку,+чтобы+скачать+превью&font=roboto";

  // сразу показываем плейсхолдер
  img.src = placeholder;
  link.href = placeholder;
  out.hidden = false;

  function parseYouTubeId(url){
    if (!url) return null;
    try{
      const u = new URL(url.trim());
      if (u.hostname.endsWith('youtu.be')) return u.pathname.split('/')[1] || null;
      if (u.searchParams.get('v')) return u.searchParams.get('v');
      if (u.pathname.startsWith('/shorts/')) return u.pathname.split('/')[2] || null;
      if (u.pathname.startsWith('/embed/'))  return u.pathname.split('/')[2] || null;
      return null;
    }catch{ return null; }
  }

  function update(){
    const id = parseYouTubeId(input.value);
    if (!id){
      img.src = placeholder;
      link.href = placeholder;
      return;
    }
    const max = `https://i.ytimg.com/vi/${id}/maxresdefault.jpg`;
    const hq  = `https://i.ytimg.com/vi/${id}/hqdefault.jpg`;
    img.src = max;
    link.href = max;
    img.onerror = () => { img.onerror=null; img.src = hq; link.href = hq; };
  }

  input.addEventListener('input', update);

  // поддержка ?url=... в адресной строке
  (function(){
    const q = new URLSearchParams(location.search).get('url');
    if (q){ input.value = q; update(); }
  })();
</script>
</body>
</html>
