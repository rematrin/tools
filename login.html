<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å Firebase</title>
</head>
<body>

    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input type="email" id="email" placeholder="Email"><br>
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å"><br>
    <input type="text" id="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"><br>
    <button id="registerBtn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>

    <script type="module">
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ Firebase (—á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, —Å–∫–∞—á–∏–≤–∞—Ç—å –Ω–µ –Ω–∞–¥–æ)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // üî¥ –í–°–¢–ê–í–¨–¢–ï –°–Æ–î–ê –í–ê–® –ö–û–ù–§–ò–ì –ò–ó –ö–û–ù–°–û–õ–ò FIREBASE
        const firebaseConfig = {
          apiKey: "AIzaSyDBNCQo3rYgmDZkZrGKT-g2t0LlpsfH1Pg",
          authDomain: "tools-c98fd.firebaseapp.com",
          projectId: "tools-c98fd",
          storageBucket: "tools-c98fd.firebasestorage.app",
          messagingSenderId: "595986762798",
          appId: "1:595986762798:web:b8c05cddcb0f3a610163bf",
          measurementId: "G-X3Z1KH8760"
        };
        // –ó–∞–ø—É—Å–∫–∞–µ–º Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        document.getElementById('registerBtn').addEventListener('click', async () => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            const name = document.getElementById('username').value;

            try {
                // 1. –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Auth (–õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å)
                const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
                const user = userCredential.user;

                // 2. –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –≤ –ë–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                // –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º user.uid –∫–∞–∫ –∏–º—è –¥–æ–∫—É–º–µ–Ω—Ç–∞. –≠—Ç–æ —Å–≤—è–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏–Ω –∏ –¥–∞–Ω–Ω—ã–µ.
                await setDoc(doc(db, "users", user.uid), {
                    username: name,
                    email: email,
                    settings: {                 // –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∑–∞–ª–æ–∂–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
                        theme: "dark",
                        notifications: true
                    },
                    createdAt: new Date()
                });

                alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å Firebase.");
                
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞:", error);
                alert("–û—à–∏–±–∫–∞: " + error.message);
            }
        });
    </script>
</body>
</html>
