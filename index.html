<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Процентные калькуляторы</title>
  <link rel="icon" type="image/png" href="percentage.png">
  <style>
    :root { --gap: 10px; --pad: 16px; }
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin: 0; padding: 28px 18px;
      line-height: 1.45;
      background: #f6f7fb; color: #0c0c0d;
    }
    .wrap { max-width: 820px; margin: 0 auto; }
    footer {
      margin-top: 28px;
      text-align: center;
      font-size: 0.95rem;
      color: #555;
    }
    footer a {
      color: #a7a9ae;
      text-decoration: none;
      margin: 0 6px;
    }
    footer a:hover {
      text-decoration: underline;
    }
    footer span {
      color: #aaa;
    }
    /* адаптивные ширины вместо фиксированных */
    input[type="text"] {
      width: clamp(6ch, 24vw, 10ch);
    }

    /* результат пусть может быть поменьше */
    .result {
      min-width: clamp(6ch, 28vw, 12ch);
    }

    /* Мобильный режим */
    @media (max-width: 430px) {
      .row {
        gap: 8px;
        font-size: 1rem;
        white-space: normal;   /* разрешаем перенос */
        flex-wrap: wrap;       /* элементы могут уходить на 2-ю строку */
      }
      .toggle .opt {           /* кнопки +/− компактнее */
        width: 34px; height: 34px;
      }
      .eq { order: 98; }       /* переносим “=” и результат на следующую строку */
      .result {
        order: 99;
        width: 100%;
        min-width: 0;
        margin-top: 4px;
      }
    }
    h1 { font-size: 1.6rem; margin: 0 0 18px; text-align: center; }
    .card {
      background: #fff; border: 1px solid #e5e7ef; border-radius: 12px;
      padding: var(--pad); margin: 0 auto 14px;
      box-shadow: 0 1px 0 rgba(0,0,0,.03);
      width: 100%;
    }
    .row {
      display: inline-flex;
      align-items: center;
      gap: var(--gap);
      font-size: 1.1rem;
      white-space: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 2px;
    }
    .row::-webkit-scrollbar { height: 6px; }
    .row::-webkit-scrollbar-thumb { background: #d6daf0; border-radius: 8px; }
    input[type="text"] {
      width: 8ch; min-width: 6ch;
      padding: 8px 10px; font-size: 1.05rem;
      border: 1px solid #cfd5e1; border-radius: 8px;
      background: #fff;
    }
    input[type="text"]:focus { outline: none; border-color: #7aa2ff; box-shadow: 0 0 0 3px rgba(122,162,255,.16); }
    .eq { font-weight: 700; }
    .result {
      min-width: 10ch; font-weight: 700; text-align: left;
      padding: 6px 10px; border-radius: 8px;
      background: #f1f4ff; border: 1px solid #dbe5ff;
    }
    .text { opacity: .9; }
    .hint { margin-top: 10px; font-size: .92rem; color: #505866; }
    code { background: #eef2ff; padding: 2px 6px; border-radius: 6px; }

    /* круглые кнопки выбора */
    .toggle {
      display: inline-flex; gap: 6px; padding: 4px; border-radius: 8px;
      background: #eef2ff; border: 1px solid #dbe5ff;
    }
    .toggle input { display: none; }
    .opt {
      display: inline-flex; align-items: center; justify-content: center;
      width: 38px; height: 38px; border-radius: 10px; cursor: pointer;
      border: 1px solid #cfd5e1; background: #fff; font-weight: 700;
      user-select: none;
    }
    .opt:has(input:checked) {
      border-color: #7aa2ff; box-shadow: 0 0 0 3px rgba(122,162,255,.16);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Процентные калькуляторы</h1>

    <!-- Calculator A: X is what percent of Y -->
    <div class="card" id="calcA">
      <div class="row">
        <input type="text" inputmode="decimal" autocomplete="off" aria-label="Число X" data-role="x">
        <span class="text">это сколько % от</span>
        <input type="text" inputmode="decimal" autocomplete="off" aria-label="Число Y" data-role="y">
        <span class="eq">=</span>
        <span class="result" data-role="out">-</span>
      </div>
    </div>

    <!-- Calculator B: N% of M -->
    <div class="card" id="calcB">
      <div class="row">
        <input type="text" inputmode="decimal" autocomplete="off" aria-label="Проценты N" data-role="n">
        <span class="text">% от</span>
        <input type="text" inputmode="decimal" autocomplete="off" aria-label="Число M" data-role="m">
        <span class="eq">=</span>
        <span class="result" data-role="out">-</span>
      </div>
    </div>

    <!-- Calculator C: X ± Y% -->
    <div class="card" id="calcC">
      <div class="row">
        <input type="text" inputmode="decimal" autocomplete="off" aria-label="Число X" data-role="x">
        <div class="toggle">
          <label class="opt"><input type="radio" name="op" value="+" checked> + </label>
          <label class="opt"><input type="radio" name="op" value="-"> − </label>
        </div>
        <input type="text" inputmode="decimal" autocomplete="off" aria-label="Проценты Y" data-role="y">
        <span class="text">%</span>
        <span class="eq">=</span>
        <span class="result" data-role="out">-</span>
      </div>
    </div>
  </div>

  <script>
    function parseNum(v) {
      if (typeof v !== 'string') return NaN;
      v = v.replace(',', '.').trim();
      if (v === '' || v === '-' || v === '.') return NaN;
      return Number(v);
    }
    function formatOut(num) {
      if (!isFinite(num)) return '-';
      const abs = Math.abs(num);
      if ((abs !== 0 && (abs < 0.01 || abs >= 1_000_000))) {
        return num.toExponential(2).replace('e', '×10^');
      }
      return (Math.round(num * 100) / 100).toString();
    }

    // Calc A
    (function(){
      const root = document.getElementById('calcA');
      const x = root.querySelector('[data-role="x"]');
      const y = root.querySelector('[data-role="y"]');
      const out = root.querySelector('[data-role="out"]');
      function recompute(){
        const xv = parseNum(x.value);
        const yv = parseNum(y.value);
        if (!isFinite(xv) || !isFinite(yv) || yv === 0) { out.textContent = '-'; return; }
        const res = (xv / yv) * 100;
        out.textContent = formatOut(res) + ' %';
      }
      x.addEventListener('input', recompute);
      y.addEventListener('input', recompute);
    })();

    // Calc B
    (function(){
      const root = document.getElementById('calcB');
      const n = root.querySelector('[data-role="n"]');
      const m = root.querySelector('[data-role="m"]');
      const out = root.querySelector('[data-role="out"]');
      function recompute(){
        const nv = parseNum(n.value);
        const mv = parseNum(m.value);
        if (!isFinite(nv) || !isFinite(mv)) { out.textContent = '-'; return; }
        const res = (nv / 100) * mv;
        out.textContent = formatOut(res);
      }
      n.addEventListener('input', recompute);
      m.addEventListener('input', recompute);
    })();

    // Calc C
    (function(){
      const root = document.getElementById('calcC');
      const x = root.querySelector('[data-role="x"]');
      const y = root.querySelector('[data-role="y"]');
      const out = root.querySelector('[data-role="out"]');
      const ops = root.querySelectorAll('input[name="op"]');
      function recompute(){
        const xv = parseNum(x.value);
        const yv = parseNum(y.value);
        if (!isFinite(xv) || !isFinite(yv)) { out.textContent = '-'; return; }
        const op = Array.from(ops).find(o => o.checked)?.value || '+';
        const delta = (yv / 100) * xv;
        const res = op === '+' ? (xv + delta) : (xv - delta);
        out.textContent = formatOut(res);
      }
      x.addEventListener('input', recompute);
      y.addEventListener('input', recompute);
      ops.forEach(o => o.addEventListener('change', recompute));
    })();
  </script>
  <footer>
  <a href="index.html">Калькулятор процентов</a>
  <span>•</span>
  <a href="fx_converter.html">Конвертер валют</a>
</footer>
</body>
</html>
